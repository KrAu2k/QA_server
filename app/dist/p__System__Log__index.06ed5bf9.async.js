"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[534],{45666:function(le,S,n){n.r(S);var R=n(97857),p=n.n(R),F=n(15009),_=n.n(F),O=n(99289),P=n.n(O),A=n(5574),v=n.n(A),f=n(67294),K=n(90930),I=n(88245),Z=n(10357),B=n(66854),W=n(68276),T=n(25278),y=n(34041),h=n(2453),U=n(17788),L=n(78957),M=n(66309),C=n(83622),c=n(86738),E=n(71230),d=n(15746),u=n(26412),g=n(96074),ie=n(87547),G=n(8751),_e=n(11475),de=n(10524),oe=n(99611),k=n(48689),z=n(24019),ce=n(37993),pe=n(33160),Ee=n(52645),j=n(42551),he=n(27484),Y=n.n(he),e=n(85893),Qe=W.default.RangePicker,Ge=T.Z.Search,ke=y.Z.Option,fe=function(){var me=(0,f.useState)(!1),H=v()(me,2),ge=H[0],w=H[1],De=(0,f.useState)(null),N=v()(De,2),D=N[0],ve=N[1],Oe=(0,f.useState)([]),V=v()(Oe,2),b=V[0],J=V[1],Pe=(0,f.useState)(!1),X=v()(Pe,2),Ce=X[0],q=X[1],Me=(0,f.useState)(null),ee=v()(Me,2),o=ee[0],je=ee[1],Ze=(0,f.useState)(!1),re=v()(Ze,2),Le=re[0],x=re[1],be=(0,f.useState)(90),ne=v()(be,2),$=ne[0],Ae=ne[1],Ie=(0,f.useState)([]),se=v()(Ie,2),Be=se[0],Te=se[1],Ue=(0,f.useState)(!1),ae=v()(Ue,2),Se=ae[0],ue=ae[1],te=function(){var l=P()(_()().mark(function r(){var t;return _()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,(0,j.ie)();case 3:t=s.sent,t.success&&ve(t.data),s.next=10;break;case 7:s.prev=7,s.t0=s.catch(0),console.error("\u83B7\u53D6\u7EDF\u8BA1\u4FE1\u606F\u5931\u8D25:",s.t0);case 10:case"end":return s.stop()}},r,null,[[0,7]])}));return function(){return l.apply(this,arguments)}}(),ye=function(){var l=P()(_()().mark(function r(){var t;return _()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,ue(!0),s.next=4,(0,j.Br)();case 4:t=s.sent,t.success&&Te(t.data),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(0),console.error("\u83B7\u53D6\u64CD\u4F5C\u7528\u6237\u5217\u8868\u5931\u8D25:",s.t0);case 11:return s.prev=11,ue(!1),s.finish(11);case 14:case"end":return s.stop()}},r,null,[[0,8,11,14]])}));return function(){return l.apply(this,arguments)}}();(0,f.useEffect)(function(){te(),ye()},[]);var Re=function(){var l=P()(_()().mark(function r(t){var i;return _()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,j.Iz)(t);case 3:i=a.sent,i.success&&(je(i.data),q(!0)),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),h.ZP.error("\u83B7\u53D6\u65E5\u5FD7\u8BE6\u60C5\u5931\u8D25");case 10:case"end":return a.stop()}},r,null,[[0,7]])}));return function(t){return l.apply(this,arguments)}}(),Fe=function(){var l=P()(_()().mark(function r(t){var i;return _()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,j.tD)(t);case 3:if(i=a.sent,!i.success){a.next=9;break}return h.ZP.success("\u5220\u9664\u6210\u529F"),a.abrupt("return",!0);case 9:return h.ZP.error(i.message||"\u5220\u9664\u5931\u8D25"),a.abrupt("return",!1);case 11:a.next=17;break;case 13:return a.prev=13,a.t0=a.catch(0),h.ZP.error("\u5220\u9664\u5931\u8D25"),a.abrupt("return",!1);case 17:case"end":return a.stop()}},r,null,[[0,13]])}));return function(t){return l.apply(this,arguments)}}(),Ke=function(){var l=P()(_()().mark(function r(){return _()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(b.length!==0){i.next=3;break}return h.ZP.warning("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u65E5\u5FD7"),i.abrupt("return");case 3:U.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:"\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684 ".concat(b.length," \u6761\u65E5\u5FD7\u5417\uFF1F"),onOk:function(){var s=P()(_()().mark(function $e(){var Q;return _()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,m.next=3,(0,j.OG)(b);case 3:if(Q=m.sent,!Q.success){m.next=10;break}return h.ZP.success("\u6279\u91CF\u5220\u9664\u6210\u529F"),J([]),m.abrupt("return",!0);case 10:return h.ZP.error(Q.message||"\u6279\u91CF\u5220\u9664\u5931\u8D25"),m.abrupt("return",!1);case 12:m.next=18;break;case 14:return m.prev=14,m.t0=m.catch(0),h.ZP.error("\u6279\u91CF\u5220\u9664\u5931\u8D25"),m.abrupt("return",!1);case 18:case"end":return m.stop()}},$e,null,[[0,14]])}));function a(){return s.apply(this,arguments)}return a}()});case 4:case"end":return i.stop()}},r)}));return function(){return l.apply(this,arguments)}}(),We=function(){var l=P()(_()().mark(function r(){var t;return _()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,(0,j.sS)($);case 3:if(t=s.sent,!t.success){s.next=10;break}return h.ZP.success("\u6E05\u7406\u6210\u529F\uFF0C\u5220\u9664\u4E86 ".concat(t.data.deletedCount," \u6761\u8FC7\u671F\u65E5\u5FD7")),x(!1),s.abrupt("return",!0);case 10:return h.ZP.error(t.message||"\u6E05\u7406\u5931\u8D25"),s.abrupt("return",!1);case 12:s.next=18;break;case 14:return s.prev=14,s.t0=s.catch(0),h.ZP.error("\u6E05\u7406\u5931\u8D25"),s.abrupt("return",!1);case 18:case"end":return s.stop()}},r,null,[[0,14]])}));return function(){return l.apply(this,arguments)}}(),we=[{title:"ID",dataIndex:"id",width:80,search:!1},{title:"\u65F6\u95F4",dataIndex:"createdAt",width:180,search:!1,render:function(r){return Y()(r).format("YYYY-MM-DD HH:mm:ss")}},{title:"\u64CD\u4F5C\u7528\u6237",dataIndex:"userName",width:120,valueType:"select",fieldProps:{showSearch:!0,allowClear:!0,loading:Se,placeholder:"\u8BF7\u9009\u62E9\u64CD\u4F5C\u7528\u6237",filterOption:function(r,t){var i;return t==null||(i=t.children)===null||i===void 0?void 0:i.toLowerCase().includes(r.toLowerCase())}},valueEnum:Be.reduce(function(l,r){return l[r.userName]=r.userName,l},{}),render:function(r,t){return(0,e.jsxs)(L.Z,{children:[(0,e.jsx)(ie.Z,{}),(0,e.jsx)("span",{children:r||"\u672A\u77E5\u7528\u6237"})]})}},{title:"\u5E94\u7528\u6A21\u5757",dataIndex:"app",width:120,render:function(r){return(0,e.jsx)(M.Z,{color:"blue",children:r})}},{title:"\u6A21\u578B",dataIndex:"model",width:120,render:function(r){return(0,e.jsx)(M.Z,{color:"green",children:r})}},{title:"\u64CD\u4F5C\u52A8\u4F5C",dataIndex:"action",width:120,render:function(r){return(0,e.jsx)(M.Z,{color:"orange",children:r})}},{title:"\u72B6\u6001",dataIndex:"status",width:100,render:function(r){return(0,e.jsx)(M.Z,{color:r==="success"?"success":"error",icon:r==="success"?(0,e.jsx)(G.Z,{}):(0,e.jsx)(_e.Z,{}),children:r==="success"?"\u6210\u529F":"\u5931\u8D25"})}},{title:"IP\u5730\u5740",dataIndex:"ipAddress",width:140,render:function(r){return(0,e.jsxs)(L.Z,{children:[(0,e.jsx)(de.Z,{}),(0,e.jsx)("span",{children:r||"-"})]})}},{title:"\u6267\u884C\u65F6\u95F4",dataIndex:"executionTime",width:120,search:!1,render:function(r){return r?"".concat(r,"ms"):"-"}},{title:"\u64CD\u4F5C\u5185\u5BB9",dataIndex:"content",ellipsis:!0,render:function(r){return(0,e.jsx)("div",{style:{maxWidth:300,wordBreak:"break-all"},children:r})}},{title:"\u64CD\u4F5C",valueType:"option",width:120,render:function(r,t){return[(0,e.jsx)(C.ZP,{type:"link",size:"small",icon:(0,e.jsx)(oe.Z,{}),onClick:function(){return Re(t.id)},children:"\u8BE6\u60C5"},"view"),(0,e.jsx)(c.Z,{title:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u6761\u65E5\u5FD7\u5417\uFF1F",onConfirm:function(){return Fe(t.id)},children:(0,e.jsx)(C.ZP,{type:"link",size:"small",danger:!0,icon:(0,e.jsx)(k.Z,{}),children:"\u5220\u9664"})},"delete")]}}],xe={labelWidth:"auto",defaultCollapsed:!1,collapsed:!1};return(0,e.jsxs)(K._z,{children:[(0,e.jsx)(I.Z,{style:{marginBottom:16},children:(0,e.jsxs)(E.Z,{gutter:16,children:[(0,e.jsx)(d.Z,{span:6,children:(0,e.jsx)(Z.Z,{title:"\u4ECA\u65E5\u65E5\u5FD7",value:(D==null?void 0:D.todayLogs)||0,prefix:(0,e.jsx)(z.Z,{}),valueStyle:{color:"#1890ff"}})}),(0,e.jsx)(d.Z,{span:6,children:(0,e.jsx)(Z.Z,{title:"\u6628\u65E5\u65E5\u5FD7",value:(D==null?void 0:D.yesterdayLogs)||0,prefix:(0,e.jsx)(z.Z,{}),valueStyle:{color:"#52c41a"}})}),(0,e.jsx)(d.Z,{span:6,children:(0,e.jsx)(Z.Z,{title:"\u603B\u65E5\u5FD7\u6570",value:(D==null?void 0:D.totalLogs)||0,prefix:(0,e.jsx)(ce.Z,{}),valueStyle:{color:"#722ed1"}})}),(0,e.jsx)(d.Z,{span:6,children:(0,e.jsx)(Z.Z,{title:"\u6210\u529F\u7387",value:(D==null?void 0:D.successRate)||"100.00",suffix:"%",prefix:(0,e.jsx)(G.Z,{}),valueStyle:{color:"#52c41a"}})})]})}),(0,e.jsx)(B.Z,{headerTitle:"\u7CFB\u7EDF\u65E5\u5FD7",rowKey:"id",search:xe,toolBarRender:function(){return[(0,e.jsx)(C.ZP,{icon:(0,e.jsx)(pe.Z,{}),onClick:function(){te()},children:"\u5237\u65B0\u7EDF\u8BA1"},"refresh"),(0,e.jsxs)(C.ZP,{danger:!0,icon:(0,e.jsx)(k.Z,{}),disabled:b.length===0,onClick:Ke,children:["\u6279\u91CF\u5220\u9664 (",b.length,")"]},"batchDelete"),(0,e.jsx)(C.ZP,{icon:(0,e.jsx)(Ee.Z,{}),onClick:function(){return x(!0)},children:"\u6E05\u7406\u8FC7\u671F\u65E5\u5FD7"},"clean")]},request:function(){var l=P()(_()().mark(function r(t){var i;return _()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return w(!0),a.prev=1,a.next=4,(0,j.Mg)(p()(p()({},t),{},{current:t.current||1,pageSize:t.pageSize||20}));case 4:return i=a.sent,w(!1),a.abrupt("return",{data:i.data||[],total:i.total||0,success:i.success});case 9:return a.prev=9,a.t0=a.catch(1),w(!1),a.abrupt("return",{data:[],total:0,success:!1});case 13:case"end":return a.stop()}},r,null,[[1,9]])}));return function(r){return l.apply(this,arguments)}}(),columns:we,rowSelection:{selectedRowKeys:b,onChange:J},pagination:{defaultPageSize:20,showSizeChanger:!0,showQuickJumper:!0},loading:ge}),(0,e.jsx)(U.Z,{title:"\u65E5\u5FD7\u8BE6\u60C5",open:Ce,onCancel:function(){return q(!1)},footer:null,width:800,children:o&&(0,e.jsxs)("div",{children:[(0,e.jsxs)(u.Z,{column:2,bordered:!0,children:[(0,e.jsx)(u.Z.Item,{label:"\u65E5\u5FD7ID",children:o.id}),(0,e.jsx)(u.Z.Item,{label:"\u521B\u5EFA\u65F6\u95F4",children:Y()(o.createdAt).format("YYYY-MM-DD HH:mm:ss")}),(0,e.jsx)(u.Z.Item,{label:"\u64CD\u4F5C\u7528\u6237",children:o.userName||"\u672A\u77E5\u7528\u6237"}),(0,e.jsx)(u.Z.Item,{label:"\u7528\u6237\u90AE\u7BB1",children:o.userEmail||"-"}),(0,e.jsx)(u.Z.Item,{label:"\u5E94\u7528\u6A21\u5757",children:o.app}),(0,e.jsx)(u.Z.Item,{label:"\u6A21\u578B",children:o.model}),(0,e.jsx)(u.Z.Item,{label:"\u64CD\u4F5C\u52A8\u4F5C",children:o.action}),(0,e.jsx)(u.Z.Item,{label:"\u72B6\u6001",children:(0,e.jsx)(M.Z,{color:o.status==="success"?"success":"error",children:o.status==="success"?"\u6210\u529F":"\u5931\u8D25"})}),(0,e.jsx)(u.Z.Item,{label:"IP\u5730\u5740",children:o.ipAddress||"-"}),(0,e.jsx)(u.Z.Item,{label:"\u6267\u884C\u65F6\u95F4",children:o.executionTime?"".concat(o.executionTime,"ms"):"-"}),(0,e.jsx)(u.Z.Item,{label:"\u5355\u636EID",span:2,children:o.billId||"-"}),(0,e.jsx)(u.Z.Item,{label:"\u64CD\u4F5C\u5185\u5BB9",span:2,children:o.content}),o.errorMessage&&(0,e.jsx)(u.Z.Item,{label:"\u9519\u8BEF\u4FE1\u606F",span:2,children:(0,e.jsx)("div",{style:{color:"#ff4d4f"},children:o.errorMessage})})]}),o.requestData&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(g.Z,{children:"\u8BF7\u6C42\u6570\u636E"}),(0,e.jsx)("pre",{style:{background:"#f5f5f5",padding:12,borderRadius:4,maxHeight:200,overflow:"auto"},children:JSON.stringify(o.requestData,null,2)})]}),o.responseData&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(g.Z,{children:"\u54CD\u5E94\u6570\u636E"}),(0,e.jsx)("pre",{style:{background:"#f5f5f5",padding:12,borderRadius:4,maxHeight:200,overflow:"auto"},children:JSON.stringify(o.responseData,null,2)})]}),o.userAgent&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(g.Z,{children:"\u7528\u6237\u4EE3\u7406"}),(0,e.jsx)("div",{style:{background:"#f5f5f5",padding:12,borderRadius:4,wordBreak:"break-all"},children:o.userAgent})]})]})}),(0,e.jsxs)(U.Z,{title:"\u6E05\u7406\u8FC7\u671F\u65E5\u5FD7",open:Le,onOk:We,onCancel:function(){return x(!1)},okText:"\u786E\u8BA4\u6E05\u7406",cancelText:"\u53D6\u6D88",children:[(0,e.jsxs)("p",{children:["\u786E\u5B9A\u8981\u6E05\u7406 ",$," \u5929\u524D\u7684\u65E5\u5FD7\u5417\uFF1F\u6B64\u64CD\u4F5C\u4E0D\u53EF\u6062\u590D\u3002"]}),(0,e.jsxs)("div",{style:{marginTop:16},children:[(0,e.jsx)("label",{children:"\u6E05\u7406\u5929\u6570\uFF1A"}),(0,e.jsx)(y.Z,{value:$,onChange:Ae,style:{width:120,marginLeft:8},options:[{label:"30\u5929",value:30},{label:"60\u5929",value:60},{label:"90\u5929",value:90},{label:"180\u5929",value:180},{label:"365\u5929",value:365}]})]})]})]})};S.default=fe},42551:function(le,S,n){n.d(S,{Br:function(){return U},CT:function(){return M},Iz:function(){return K},Mg:function(){return P},OG:function(){return W},ie:function(){return v},sS:function(){return y},tD:function(){return Z}});var R=n(15009),p=n.n(R),F=n(99289),_=n.n(F),O=n(45618);function P(c){return A.apply(this,arguments)}function A(){return A=_()(p()().mark(function c(E){return p()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,O.request)("/api/logs",{method:"GET",params:E}));case 1:case"end":return u.stop()}},c)})),A.apply(this,arguments)}function v(){return f.apply(this,arguments)}function f(){return f=_()(p()().mark(function c(){return p()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,O.request)("/api/logs/stats",{method:"GET"}));case 1:case"end":return d.stop()}},c)})),f.apply(this,arguments)}function K(c){return I.apply(this,arguments)}function I(){return I=_()(p()().mark(function c(E){return p()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,O.request)("/api/logs/".concat(E),{method:"GET"}));case 1:case"end":return u.stop()}},c)})),I.apply(this,arguments)}function Z(c){return B.apply(this,arguments)}function B(){return B=_()(p()().mark(function c(E){return p()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,O.request)("/api/logs/".concat(E),{method:"DELETE"}));case 1:case"end":return u.stop()}},c)})),B.apply(this,arguments)}function W(c){return T.apply(this,arguments)}function T(){return T=_()(p()().mark(function c(E){return p()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,O.request)("/api/logs/batch-delete",{method:"POST",data:{ids:E}}));case 1:case"end":return u.stop()}},c)})),T.apply(this,arguments)}function y(){return h.apply(this,arguments)}function h(){return h=_()(p()().mark(function c(){var E,d=arguments;return p()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return E=d.length>0&&d[0]!==void 0?d[0]:90,g.abrupt("return",(0,O.request)("/api/logs/clean-expired",{method:"POST",data:{days:E}}));case 2:case"end":return g.stop()}},c)})),h.apply(this,arguments)}function U(){return L.apply(this,arguments)}function L(){return L=_()(p()().mark(function c(){return p()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,O.request)("/api/logs/users",{method:"GET"}));case 1:case"end":return d.stop()}},c)})),L.apply(this,arguments)}function M(c,E){return C.apply(this,arguments)}function C(){return C=_()(p()().mark(function c(E,d){return p()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",(0,O.request)("/api/logs/user/".concat(E,"/login-logs"),{method:"GET",params:{limit:d}}));case 1:case"end":return g.stop()}},c)})),C.apply(this,arguments)}}}]);
